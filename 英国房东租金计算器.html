<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Savills | 英国房东租金计算器 UK Landlord Rent Calculator</title>
  <style>
    :root{
      --navy:#0b1f3a;
      --navy2:#102a4c;
      --border:#d7dde6;
      --muted:#5b6675;
      --bg:#f6f7f9;
      --card:#ffffff;
      --good:#0a7a3b;
      --bad:#9b1c1c;
      --btn:#eef3fb;
      --radius:14px;
      --field-radius:12px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "PingFang SC","Microsoft YaHei";
      background:var(--bg);
      color:#0a0f18;
      line-height:1.35;
      -webkit-text-size-adjust: 100%;
    }
    header{
      background:linear-gradient(180deg,var(--navy),var(--navy2));
      color:#fff;
      padding:18px 14px;
    }
    .wrap{max-width:1100px;margin:0 auto;padding:0 10px;}
    .topbar{display:flex;gap:14px;align-items:center;justify-content:space-between;flex-wrap:wrap;}
    .brand{display:flex;gap:12px;align-items:center;min-width:0;}
    .brand img{height:36px;width:auto;background:#fff;border-radius:10px;padding:6px;}
    .title{min-width:0;}
    .title h1{
      font-size:18px;margin:0;font-weight:900;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .vatline{
      margin-top:6px;
      font-size:12px;
      color:rgba(255,255,255,.85);
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }

    main{padding:14px 12px 24px;}
    .grid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:14px;
      align-items:start;
    }

    /* iPad/Tablet: still two columns but a bit tighter */
    @media (max-width: 980px){
      .grid{grid-template-columns: 1fr;}
      .title h1{white-space:normal}
      .vatline{white-space:normal}
    }

    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:14px;
      box-shadow:0 6px 20px rgba(20,35,60,.06);
    }
    .card h2{
      font-size:14px;margin:0 0 10px;font-weight:900;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }

    /* --- Form layout: aligned fields --- */
    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      align-items:start;
    }
    /* Mobile: one column */
    @media (max-width: 640px){
      .row{grid-template-columns:1fr;}
    }

    .field{
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width:0;
    }

    /* One-line labels (no wrap). If too long, show ellipsis */
    label{
      font-size:12px;
      color:var(--muted);
      margin:0;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      line-height:1.25;
    }

    /* Inputs: consistent height */
    input, select{
      width:100%;
      height:44px;                 /* consistent */
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:var(--field-radius);
      background:#fff;
      font-size:14px;
      outline:none;
      appearance:none;
      -webkit-appearance:none;
    }
    input:focus, select:focus{
      border-color:#92a3bf;
      box-shadow:0 0 0 3px rgba(146,163,191,.25);
    }

    /* Small helper text (single line as well) */
    .help{
      font-size:11px;
      color:var(--muted);
      margin:0;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .divider{height:1px;background:var(--border);margin:12px 0}

    /* Results */
    .kpi{
      display:flex;justify-content:space-between;gap:12px;align-items:baseline;
      padding:10px 0;
      border-bottom:1px solid rgba(215,221,230,.65);
    }
    .kpi:last-child{border-bottom:none}
    .kpi span{
      color:var(--muted);font-size:12px;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
      max-width:72%;
    }
    .kpi strong{font-size:14px; white-space:nowrap;}
    .money{font-variant-numeric: tabular-nums;}
    .good{color:var(--good)}
    .bad{color:var(--bad)}

    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      overflow:hidden;
      border:1px solid var(--border);
      border-radius:12px;
      background:#fff;
    }
    th,td{padding:10px 10px;border-bottom:1px solid var(--border);font-size:13px}
    th{background:#f2f5fa;text-align:left;color:#273244;font-weight:900}
    tr:last-child td{border-bottom:none}
    td:first-child{
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
      max-width:1px; /* allow ellipsis */
    }
    .right{text-align:right; white-space:nowrap;}

    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px;}
    .btn{
      border:1px solid var(--border);
      background:var(--btn);
      padding:10px 14px;
      border-radius:12px;
      cursor:pointer;
      font-size:13px;
      font-weight:800;
      height:44px;
    }
    .btn.secondary{background:#fff;}
    .toast{margin-top:10px;font-size:12px;color:var(--muted);min-height:16px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
  </style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <img alt="Savills 标志｜Savills Logo" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/Savills_logo.svg/500px-Savills_logo.svg.png" />
        <div class="title">
          <h1>英国房东租金计算器｜UK Landlord Rent Calculator</h1>
          <div class="vatline">所有费用已包含增值税（VAT）｜All fees are inclusive of VAT</div>
        </div>
      </div>
    </div>
  </div>
</header>

<main>
  <div class="wrap">
    <div class="grid">

      <section class="card">
        <h2>1) 基本信息｜Basic Information</h2>

        <div class="row">
          <div class="field">
            <label title="月租金（£/月）｜Monthly Rent (£/month)">月租金（£/月）｜Monthly Rent (£/month)</label>
            <input id="monthlyRent" type="number" min="0" step="50" value="4000" data-default="4000" />
          </div>
          <div class="field">
            <label title="租期（月）｜Tenancy Length (months)">租期（月）｜Tenancy Length (months)</label>
            <input id="months" type="number" min="1" step="1" value="12" data-default="12" />
          </div>
        </div>

        <div class="divider"></div>

        <h2>2) Savills 服务｜Savills Service</h2>

        <div class="row">
          <div class="field">
            <label title="服务类型｜Service Type">服务类型｜Service Type</label>
            <select id="serviceType" data-default="let_rent">
              <option value="let_rent">出租 + 收租｜Letting & Rent Collection</option>
              <option value="let_mgmt">出租 + 全权管理｜Letting + Fully Managed</option>
              <option value="mgmt_only">仅管理｜Management Only</option>
              <option value="short_let_rent">短租（少于6个月）收租｜Short Let (&lt;6m) Rent Collection</option>
              <option value="short_let_mgmt">短租（少于6个月）管理｜Short Let (&lt;6m) Managed</option>
            </select>
          </div>

          <div class="field">
            <label title="Savills 费率（含VAT，%）｜Savills Fee Rate (incl. VAT, %)">Savills 费率（含VAT，%）｜Savills Fee Rate (incl. VAT, %)</label>
            <input id="serviceRatePct" type="number" min="0" step="0.1" value="15" data-default="15" />
            <p class="help" title="请输入合同约定的含VAT费率。｜Enter the agreed VAT-inclusive rate.">请输入合同约定的含VAT费率。｜Enter the agreed VAT-inclusive rate.</p>
          </div>
        </div>

        <div class="row" style="margin-top:10px;">
          <div class="field">
            <label title="固定费用（如适用，£）｜Fixed Fee (if applicable, £)">固定费用（如适用，£）｜Fixed Fee (if applicable, £)</label>
            <input id="fixedFee" type="number" min="0" step="10" value="0" data-default="0" />
            <p class="help" title="例如：handover 等一次性固定费用。｜E.g., one-off handover fee.">例如：handover 等一次性固定费用。｜E.g., one-off handover fee.</p>
          </div>
          <div class="field">
            <label title="税率｜Income Tax Rate">税率｜Income Tax Rate</label>
            <div class="row" style="grid-template-columns: 1fr 1fr; gap:10px;">
              <select id="taxRatePreset" data-default="20">
                <option value="20" selected>20%（基本税率）｜20% (Basic)</option>
                <option value="40">40%（高税率）｜40% (Higher)</option>
                <option value="45">45%（额外税率）｜45% (Additional)</option>
                <option value="custom">自定义｜Custom</option>
              </select>
              <input id="taxRateCustom" type="number" min="0" step="0.1" value="20" data-default="20" disabled
                     title="自定义税率（%）｜Custom tax rate (%)" />
            </div>
            <p class="help" title="简化估算：税 = max(0, 税前利润) × 税率。｜Simplified: tax = max(0, profit before tax) × rate.">
              简化估算：税 = max(0, 税前利润) × 税率。｜Simplified: tax = max(0, profit before tax) × rate.
            </p>
          </div>
        </div>

        <div class="divider"></div>

        <h2>3) 出租期间支出｜Running Costs (during tenancy)</h2>

        <div class="row">
          <div class="field">
            <label title="物业费（£/年）｜Service Charge (£/year)">物业费（£/年）｜Service Charge (£/year)</label>
            <input id="serviceChargeYear" type="number" min="0" step="50" value="5000" data-default="5000" />
          </div>
          <div class="field">
            <label title="地租（£/年）｜Ground Rent (£/year)">地租（£/年）｜Ground Rent (£/year)</label>
            <input id="groundRentYear" type="number" min="0" step="10" value="0" data-default="0" />
          </div>
        </div>

        <div class="row" style="margin-top:10px;">
          <div class="field">
            <label title="房东保险（£/年）｜Landlord Insurance (£/year)">房东保险（£/年）｜Landlord Insurance (£/year)</label>
            <input id="insuranceYear" type="number" min="0" step="10" value="300" data-default="300" />
          </div>
          <div class="field">
            <label title="维修/维护预算（£/月）｜Maintenance Budget (£/month)">维修/维护预算（£/月）｜Maintenance Budget (£/month)</label>
            <input id="maintenanceMonth" type="number" min="0" step="10" value="200" data-default="200" />
          </div>
        </div>

        <div class="divider"></div>

        <h2>4) 常见一次性及附加费用｜Common One-off & Additional Charges</h2>

        <div class="row">
          <div class="field">
            <label title="租约文件费（£）｜Tenancy Paperwork (£)">租约文件费（£）｜Tenancy Paperwork (£)</label>
            <input id="tenancyPaperwork" type="number" min="0" step="10" value="360" data-default="360" />
          </div>
          <div class="field">
            <label title="续约文件费（£）｜Renewal Paperwork (£)">续约文件费（£）｜Renewal Paperwork (£)</label>
            <input id="renewalPaperwork" type="number" min="0" step="10" value="0" data-default="0" />
          </div>
        </div>

        <div class="row" style="margin-top:10px;">
          <div class="field">
            <label title="租住权检查：人数（£60/人）｜Right to Rent: people (£60/person)">租住权检查：人数（£60/人）｜Right to Rent: people (£60/person)</label>
            <input id="rtrPeople" type="number" min="0" step="1" value="1" data-default="1" />
          </div>
          <div class="field">
            <label title="背景调查：人数（£45/人）｜References: people (£45/person)">背景调查：人数（£45/人）｜References: people (£45/person)</label>
            <input id="refPeople" type="number" min="0" step="1" value="1" data-default="1" />
          </div>
        </div>

        <div class="row" style="margin-top:10px;">
          <div class="field">
            <label title="押金注册：年数（£60/年）｜Deposit Registration: years (£60/year)">押金注册：年数（£60/年）｜Deposit Registration: years (£60/year)</label>
            <input id="depositYears" type="number" min="0" step="1" value="1" data-default="1" />
          </div>
          <div class="field">
            <label title="清单/验房报告（总计，£）｜Inventory (total, £)">清单/验房报告（总计，£）｜Inventory (total, £)</label>
            <input id="inventoryTotal" type="number" min="0" step="10" value="300" data-default="300" />
          </div>
        </div>

        <div class="row" style="margin-top:10px;">
          <div class="field">
            <label title="其他一次性费用（£）｜Other One-off Costs (£)">其他一次性费用（£）｜Other One-off Costs (£)</label>
            <input id="otherOneOff" type="number" min="0" step="10" value="300" data-default="300" />
          </div>
          <div class="field">
            <label title="其他每月费用（£/月）｜Other Monthly Costs (£/month)">其他每月费用（£/月）｜Other Monthly Costs (£/month)</label>
            <input id="otherMonthly" type="number" min="0" step="10" value="0" data-default="0" />
          </div>
        </div>
      </section>

      <aside class="card">
        <h2>结果｜Results</h2>

        <div class="kpi">
          <span title="总租金收入（租金 × 月数）｜Gross Rent (rent × months)">总租金收入（租金 × 月数）｜Gross Rent (rent × months)</span>
          <strong id="grossRent" class="money">£0</strong>
        </div>
        <div class="kpi">
          <span title="Savills 费用（含VAT）｜Savills Fee (incl. VAT)">Savills 费用（含VAT）｜Savills Fee (incl. VAT)</span>
          <strong id="savillsFee" class="money">£0</strong>
        </div>
        <div class="kpi">
          <span title="出租期间支出｜Running Costs">出租期间支出｜Running Costs</span>
          <strong id="runningCosts" class="money">£0</strong>
        </div>
        <div class="kpi">
          <span title="一次性及附加费用｜One-off & Additional Charges">一次性及附加费用｜One-off & Additional Charges</span>
          <strong id="oneOffCosts" class="money">£0</strong>
        </div>

        <div class="divider"></div>

        <div class="kpi">
          <span title="税前利润｜Profit Before Tax"><b>税前利润｜Profit Before Tax</b></span>
          <strong id="profitBeforeTax" class="money">£0</strong>
        </div>
        <div class="kpi">
          <span title="预计个人所得税｜Estimated Income Tax">预计个人所得税｜Estimated Income Tax</span>
          <strong id="incomeTax" class="money">£0</strong>
        </div>
        <div class="kpi">
          <span title="税后净收入｜Net Income After Tax"><b>税后净收入｜Net Income After Tax</b></span>
          <strong id="netAfterTax" class="money good">£0</strong>
        </div>
        <div class="kpi">
          <span title="税后净收入/月｜Net Income After Tax / month">税后净收入/月｜Net Income After Tax / month</span>
          <strong id="netAfterTaxPerMonth" class="money">£0</strong>
        </div>

        <div class="divider"></div>

        <h2>明细｜Breakdown</h2>
        <table aria-label="明细表｜Breakdown table">
          <thead>
            <tr>
              <th>项目｜Item</th>
              <th class="right">金额｜Amount</th>
            </tr>
          </thead>
          <tbody id="breakdownBody"></tbody>
        </table>

        <div class="actions">
          <button class="btn" type="button" id="copyBtn">一键复制明细｜Copy Breakdown</button>
          <button class="btn secondary" type="button" id="resetBtn">重置｜Reset</button>
        </div>
        <div class="toast" id="toast"></div>
      </aside>

    </div>
  </div>
</main>

<script>
  const $ = (id) => document.getElementById(id);

  const DEFAULT_RATE_PCT = {
    let_rent: 15.0,
    let_mgmt: 20.4,
    mgmt_only: 7.2,
    short_let_rent: 24.0,
    short_let_mgmt: 30.0
  };

  const DEFAULT_FIXED_FEE = {
    let_rent: 0,
    let_mgmt: 0,
    mgmt_only: 600,
    short_let_rent: 0,
    short_let_mgmt: 0
  };

  function clampInt(v, min=0){
    const n = Math.floor(Number(v));
    return Number.isFinite(n) ? Math.max(min, n) : min;
  }
  function num(id){
    const v = parseFloat($(id).value);
    return Number.isFinite(v) ? v : 0;
  }
  function money(n){
    const v = Number.isFinite(n) ? n : 0;
    return "£" + v.toLocaleString(undefined, {maximumFractionDigits: 0});
  }

  function getTaxRate(){
    const preset = $("taxRatePreset").value;
    if (preset === "custom") return Math.max(0, num("taxRateCustom")) / 100;
    return Math.max(0, parseFloat(preset)) / 100;
  }

  function recalc(){
    const monthlyRent = Math.max(0, num("monthlyRent"));
    const months = Math.max(1, clampInt($("months").value, 1));
    $("months").value = months;

    const serviceRate = Math.max(0, num("serviceRatePct")) / 100;
    const fixedFee = Math.max(0, num("fixedFee"));
    const grossRent = monthlyRent * months;

    const savillsFee = (grossRent * serviceRate) + fixedFee;

    const serviceChargeYear = Math.max(0, num("serviceChargeYear"));
    const groundRentYear = Math.max(0, num("groundRentYear"));
    const insuranceYear = Math.max(0, num("insuranceYear"));
    const maintenanceMonth = Math.max(0, num("maintenanceMonth"));
    const otherMonthly = Math.max(0, num("otherMonthly"));

    const serviceChargePeriod = serviceChargeYear * (months / 12);
    const groundRentPeriod = groundRentYear * (months / 12);
    const insurancePeriod = insuranceYear * (months / 12);

    const runningCosts =
      (serviceChargePeriod + groundRentPeriod + insurancePeriod) +
      (maintenanceMonth + otherMonthly) * months;

    const tenancyPaperwork = Math.max(0, num("tenancyPaperwork"));
    const renewalPaperwork = Math.max(0, num("renewalPaperwork"));
    const rtrPeople = Math.max(0, clampInt($("rtrPeople").value, 0)); $("rtrPeople").value = rtrPeople;
    const refPeople = Math.max(0, clampInt($("refPeople").value, 0)); $("refPeople").value = refPeople;
    const depositYears = Math.max(0, clampInt($("depositYears").value, 0)); $("depositYears").value = depositYears;
    const inventoryTotal = Math.max(0, num("inventoryTotal"));
    const otherOneOff = Math.max(0, num("otherOneOff"));

    const rightToRentCost = (rtrPeople * 60);
    const referencesCost = (refPeople * 45);
    const depositRegCost = (depositYears * 60);

    const oneOffCosts =
      tenancyPaperwork +
      renewalPaperwork +
      rightToRentCost +
      referencesCost +
      depositRegCost +
      inventoryTotal +
      otherOneOff;

    const profitBeforeTax = grossRent - savillsFee - runningCosts - oneOffCosts;

    const taxRate = getTaxRate();
    const taxableProfit = Math.max(0, profitBeforeTax);
    const incomeTax = taxableProfit * taxRate;

    const netAfterTax = profitBeforeTax - incomeTax;
    const netAfterTaxPerMonth = netAfterTax / months;

    $("grossRent").textContent = money(grossRent);
    $("savillsFee").textContent = money(savillsFee);
    $("runningCosts").textContent = money(runningCosts);
    $("oneOffCosts").textContent = money(oneOffCosts);

    $("profitBeforeTax").textContent = money(profitBeforeTax);
    $("incomeTax").textContent = money(incomeTax);

    $("netAfterTax").textContent = money(netAfterTax);
    $("netAfterTax").className = "money " + (netAfterTax >= 0 ? "good" : "bad");
    $("netAfterTaxPerMonth").textContent = money(netAfterTaxPerMonth);

    const rows = [
      ["总租金收入｜Gross Rent", grossRent],
      ["Savills 费用（含VAT）｜Savills Fee (incl. VAT)", -savillsFee],
      ["物业费｜Service Charge", -serviceChargePeriod],
      ["地租｜Ground Rent", -groundRentPeriod],
      ["房东保险｜Landlord Insurance", -insurancePeriod],
      ["维修/维护预算｜Maintenance Budget", -(maintenanceMonth * months)],
      ["其他每月费用｜Other Monthly Costs", -(otherMonthly * months)],
      ["租约文件费｜Tenancy Paperwork", -tenancyPaperwork],
      ["续约文件费｜Renewal Paperwork", -renewalPaperwork],
      ["租住权检查｜Right to Rent", -rightToRentCost],
      ["背景调查｜References", -referencesCost],
      ["押金注册｜Deposit Registration", -depositRegCost],
      ["清单/验房报告（总计）｜Inventory (total)", -inventoryTotal],
      ["其他一次性费用｜Other One-off Costs", -otherOneOff],
      ["税前利润｜Profit Before Tax", profitBeforeTax],
      ["预计个人所得税｜Estimated Income Tax", -incomeTax],
      ["税后净收入｜Net Income After Tax", netAfterTax]
    ];

    const body = $("breakdownBody");
    body.innerHTML = "";
    rows.forEach(([k,v])=>{
      const isKey = k.includes("总租金") || k.includes("Savills") || k.includes("税前利润") || k.includes("税后净收入") || k.includes("所得税");
      if (!isKey && Math.abs(v) < 0.0001) return;

      const tr = document.createElement("tr");
      const td1 = document.createElement("td");
      const td2 = document.createElement("td");
      td1.textContent = k;
      td2.textContent = money(v);
      td2.className = "right money";
      if (k.includes("税后净收入")){
        td1.style.fontWeight = "900";
        td2.style.fontWeight = "900";
      }
      tr.appendChild(td1);
      tr.appendChild(td2);
      body.appendChild(tr);
    });

    window.__calcSnapshot = {
      inputs: {
        monthlyRent, months,
        serviceType: $("serviceType").value,
        serviceRatePct: Math.max(0, num("serviceRatePct")),
        fixedFee,
        taxRatePct: (taxRate*100),
      }
    };
  }

  function setToast(msg){
    $("toast").textContent = msg || "";
    if (msg) setTimeout(()=>{ $("toast").textContent = ""; }, 2500);
  }

  $("serviceType").addEventListener("change", ()=>{
    const t = $("serviceType").value;
    $("serviceRatePct").value = DEFAULT_RATE_PCT[t] ?? 0;
    $("fixedFee").value = DEFAULT_FIXED_FEE[t] ?? 0;
    recalc();
  });

  $("taxRatePreset").addEventListener("change", ()=>{
    const v = $("taxRatePreset").value;
    const custom = $("taxRateCustom");
    if (v === "custom"){
      custom.disabled = false;
      custom.focus();
    } else {
      custom.disabled = true;
      custom.value = v;
    }
    recalc();
  });

  $("copyBtn").addEventListener("click", async ()=>{
    try{
      const lines = [];
      lines.push("英国房东租金计算｜UK Landlord Rent Calculation");
      lines.push("");

      const rows = Array.from(document.querySelectorAll("#breakdownBody tr")).map(tr=>{
        const tds = tr.querySelectorAll("td");
        return `${tds[0].textContent}: ${tds[1].textContent}`;
      });
      lines.push("明细｜Breakdown");
      lines.push(...rows);

      const text = lines.join("\n");

      if (navigator.clipboard && navigator.clipboard.writeText){
        await navigator.clipboard.writeText(text);
        setToast("已复制到剪贴板｜Copied to clipboard");
      } else {
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        document.body.removeChild(ta);
        setToast("已复制到剪贴板｜Copied to clipboard");
      }
    } catch(e){
      setToast("复制失败，请重试｜Copy failed, please try again");
    }
  });

  $("resetBtn").addEventListener("click", ()=>{
    const inputs = document.querySelectorAll("input[data-default], select[data-default]");
    inputs.forEach(el=>{ el.value = el.getAttribute("data-default"); });

    const t = $("serviceType").value;
    $("serviceRatePct").value = DEFAULT_RATE_PCT[t] ?? num("serviceRatePct");
    $("fixedFee").value = DEFAULT_FIXED_FEE[t] ?? num("fixedFee");

    const v = $("taxRatePreset").value;
    if (v === "custom"){
      $("taxRateCustom").disabled = false;
    } else {
      $("taxRateCustom").disabled = true;
      $("taxRateCustom").value = v;
    }

    recalc();
    setToast("已重置为默认值｜Reset to defaults");
  });

  const ids = [
    "monthlyRent","months",
    "serviceType","serviceRatePct","fixedFee",
    "taxRatePreset","taxRateCustom",
    "serviceChargeYear","groundRentYear","insuranceYear","maintenanceMonth",
    "tenancyPaperwork","renewalPaperwork","rtrPeople","refPeople","depositYears","inventoryTotal","otherOneOff","otherMonthly"
  ];
  ids.forEach(id=>{
    $(id).addEventListener("input", recalc);
    $(id).addEventListener("change", recalc);
  });

  (function init(){
    const t = $("serviceType").value;
    $("serviceRatePct").value = DEFAULT_RATE_PCT[t] ?? num("serviceRatePct");
    $("fixedFee").value = DEFAULT_FIXED_FEE[t] ?? num("fixedFee");

    const preset = $("taxRatePreset").value;
    if (preset !== "custom"){
      $("taxRateCustom").value = preset;
      $("taxRateCustom").disabled = true;
    }
    recalc();
  })();
</script>
</body>
</html>
